



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>API reference - pytest_harvest</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.1b62728e.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#api-reference" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="pytest_harvest" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              pytest_harvest
            </span>
            <span class="md-header-nav__topic">
              
                API reference
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/smarie/python-pytest-harvest/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="pytest_harvest" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    pytest_harvest
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/smarie/python-pytest-harvest/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        API reference
      </label>
    
    <a href="./" title="API reference" class="md-nav__link md-nav__link--active">
      API reference
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-available-fixtures" class="md-nav__link">
    1. Available fixtures
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#results_bag" class="md-nav__link">
    results_bag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixture_store" class="md-nav__link">
    fixture_store
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session_results_dct" class="md-nav__link">
    session_results_dct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module_results_dct" class="md-nav__link">
    module_results_dct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session_results_df" class="md-nav__link">
    session_results_df
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module_results_df" class="md-nav__link">
    module_results_df
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-additional-symbols" class="md-nav__link">
    2. Additional symbols
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-basic" class="md-nav__link">
    a- Basic
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#saved_fixture" class="md-nav__link">
    @saved_fixture
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resultsbag-class" class="md-nav__link">
    ResultsBag class
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-intermediate" class="md-nav__link">
    b- Intermediate
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_results_bag_fixture" class="md-nav__link">
    create_results_bag_fixture(...)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-advanced" class="md-nav__link">
    c- Advanced
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_session_synthesis_dct" class="md-nav__link">
    get_session_synthesis_dct(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter_session_items" class="md-nav__link">
    filter_session_items(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytest_item_matches_filter" class="md-nav__link">
    pytest_item_matches_filter(...)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-pytest-utils" class="md-nav__link">
    d- Pytest utils
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_all_pytest_fixture_names" class="md-nav__link">
    get_all_pytest_fixture_names(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_all_pytest_param_names" class="md-nav__link">
    get_all_pytest_param_names(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_fixture_value" class="md-nav__link">
    get_fixture_value(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_pytest_status" class="md-nav__link">
    get_pytest_status(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_pytest_incomplete" class="md-nav__link">
    is_pytest_incomplete(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_pytest_param_names" class="md-nav__link">
    get_pytest_param_names(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_pytest_params" class="md-nav__link">
    get_pytest_params(...)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../advanced_usage/" title="Advanced Usage" class="md-nav__link">
      Advanced Usage
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-available-fixtures" class="md-nav__link">
    1. Available fixtures
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#results_bag" class="md-nav__link">
    results_bag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixture_store" class="md-nav__link">
    fixture_store
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session_results_dct" class="md-nav__link">
    session_results_dct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module_results_dct" class="md-nav__link">
    module_results_dct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session_results_df" class="md-nav__link">
    session_results_df
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module_results_df" class="md-nav__link">
    module_results_df
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-additional-symbols" class="md-nav__link">
    2. Additional symbols
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-basic" class="md-nav__link">
    a- Basic
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#saved_fixture" class="md-nav__link">
    @saved_fixture
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resultsbag-class" class="md-nav__link">
    ResultsBag class
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-intermediate" class="md-nav__link">
    b- Intermediate
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_results_bag_fixture" class="md-nav__link">
    create_results_bag_fixture(...)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-advanced" class="md-nav__link">
    c- Advanced
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_session_synthesis_dct" class="md-nav__link">
    get_session_synthesis_dct(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter_session_items" class="md-nav__link">
    filter_session_items(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytest_item_matches_filter" class="md-nav__link">
    pytest_item_matches_filter(...)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-pytest-utils" class="md-nav__link">
    d- Pytest utils
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_all_pytest_fixture_names" class="md-nav__link">
    get_all_pytest_fixture_names(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_all_pytest_param_names" class="md-nav__link">
    get_all_pytest_param_names(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_fixture_value" class="md-nav__link">
    get_fixture_value(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_pytest_status" class="md-nav__link">
    get_pytest_status(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_pytest_incomplete" class="md-nav__link">
    is_pytest_incomplete(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_pytest_param_names" class="md-nav__link">
    get_pytest_param_names(...)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_pytest_params" class="md-nav__link">
    get_pytest_params(...)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/smarie/python-pytest-harvest/edit/master/docs/api_reference.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="api-reference">API reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<h2 id="1-available-fixtures">1. Available fixtures<a class="headerlink" href="#1-available-fixtures" title="Permanent link">&para;</a></h2>
<p>The following fixtures can be used in your tests as soon as the library is installed (no explicit plugin activation is required).</p>
<h3 id="results_bag"><em><code>results_bag</code></em><a class="headerlink" href="#results_bag" title="Permanent link">&para;</a></h3>
<p>A <em>"results bag"</em> fixture: a dictionary where you can store anything (results, context, etc.) during your tests execution. It offers a "much"-like api: you can access all entries using the object protocol such as in <code>results_bag.a = 1</code>.</p>
<p>This fixture has function-scope so a new, empty instance is injected in each test node. </p>
<p>There are several ways to gather all results after they have been stored. </p>
<ul>
<li>
<p>To get the raw stored results, use the <code>fixture_store</code> fixture: <code>fixture_store['results_bag']</code> will contain all result bags for all tests.</p>
</li>
<li>
<p>If you are interested in both the stored results AND some stored fixture values (through <code>@saved_fixture</code>), you might rather wish to leverage the following helpers:</p>
<ul>
<li>
<p>use one of the <code>session_results_dct</code>, <code>module_results_dct</code>, <code>session_results_df</code> or <code>module_results_df</code> fixtures. They contain all available information, in a nicely summarized way.</p>
</li>
<li>
<p>use the <code>get_session_synthesis_dct(session)</code> helper method to create a similar synthesis than the above with more customization capabilities.</p>
</li>
</ul>
</li>
</ul>
<p>If you wish to create custom results bags similar to this one (for example to create several with different names), use <a href="#create_results_bag_fixture"><code>create_results_bag_fixture</code></a>.</p>
<p>See <a href="..#b-collecting-test-artifacts">basic</a> and <a href="../advanced_usage/#3-creating-results-bags-fixtures-to-collect-test-artifacts">advanced</a> documentation for details.</p>
<h3 id="fixture_store"><em><code>fixture_store</code></em><a class="headerlink" href="#fixture_store" title="Permanent link">&para;</a></h3>
<p>A 'fixture store' fixture: a dictionary where fixture instances can be saved.</p>
<p>By default</p>
<ul>
<li>all fixtures decorated with <a href="#saved_fixture"><code>@saved_fixture</code></a> are saved in this store.</li>
<li>the <a href="#results_bag"><code>results_bag</code></a> fixture is also saved in this store.</li>
</ul>
<p>To retrieve the contents of the store, you can:</p>
<ul>
<li>create a test using this fixture and make sure that it is executed after all others. </li>
<li>access this fixture from a dependent fixture and read its value in the setup or teardown script.</li>
<li>access this fixture from the <code>request</code> fixture using the <a href="#get_fixture_value"><code>get_fixture_value</code></a> helper method.</li>
</ul>
<p>This fixture has session scope so it is unique across the whole session. </p>
<h3 id="session_results_dct"><em><code>session_results_dct</code></em><a class="headerlink" href="#session_results_dct" title="Permanent link">&para;</a></h3>
<p>This fixture contains a synthesis dictionary for all tests completed "so far", with 'full' id format. It includes contents from the default <code>fixture_store</code>, including <code>results_bag</code>.</p>
<p>Behind the scenes it relies on <code>get_session_synthesis_dct</code>.</p>
<p>This fixture has a function scope because we want its contents to be refreshed every time it is needed.</p>
<p>See <a href="..#c--collecting-a-synthesis">documentation</a> for details.</p>
<h3 id="module_results_dct"><em><code>module_results_dct</code></em><a class="headerlink" href="#module_results_dct" title="Permanent link">&para;</a></h3>
<p>Same than <a href="#session_results_dct"><code>session_results_dct</code></a> but with module scope.</p>
<h3 id="session_results_df"><em><code>session_results_df</code></em><a class="headerlink" href="#session_results_df" title="Permanent link">&para;</a></h3>
<p>This fixture contains a synthesis dataframe for all tests completed "so far" in the module of the caller,
with 'function' id format. It includes contents from the default <code>fixture_store</code>, including <code>results_bag</code>.</p>
<p>It is basically just a transformation of the <code>session_results_dct</code> fixture into a pandas <code>DataFrame</code>.</p>
<p>If <code>pytest-steps</code> is installed, the step ids will be extracted and the dataframe index will be multi-level
(test id without step, step id).</p>
<p>This fixture has a function scope because we want its contents to be refreshed every time it is needed.</p>
<p>See <a href="..#c--collecting-a-synthesis">documentation</a> for details.</p>
<h3 id="module_results_df"><em><code>module_results_df</code></em><a class="headerlink" href="#module_results_df" title="Permanent link">&para;</a></h3>
<p>Same than <a href="#session_results_df"><code>session_results_df</code></a> but with module scope.</p>
<h2 id="2-additional-symbols">2. Additional symbols<a class="headerlink" href="#2-additional-symbols" title="Permanent link">&para;</a></h2>
<h3 id="a-basic">a- Basic<a class="headerlink" href="#a-basic" title="Permanent link">&para;</a></h3>
<h4 id="saved_fixture"><code>@saved_fixture</code><a class="headerlink" href="#saved_fixture" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nd">@saved_fixture</span><span class="p">(</span><span class="n">store</span><span class="o">=</span><span class="s1">&#39;fixture_store&#39;</span><span class="p">,</span>  <span class="c1"># type: Union[str, Dict[str, Any]]</span>
               <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>               <span class="c1"># type: str</span>
               <span class="n">views</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>             <span class="c1"># type: Dict[str, Callable[[Any], Any]]</span>
               <span class="n">save_raw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>          <span class="c1"># type: bool</span>
               <span class="p">)</span>
</pre></div>


<p>Decorates a fixture so that it is saved in <code>store</code>. <code>store</code> can be a dict-like variable or a string representing a fixture name to a dict-like session-scoped fixture. By default it uses the global 'fixture_store' fixture provided by this plugin.</p>
<p>After executing all tests, <code>&lt;store&gt;</code> will contain a new item under key <code>&lt;key&gt;</code> (default is the name of the fixture). This item is a dictionary <test_id>: <fixture_value> for each test node where the fixture was setup.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">from</span> <span class="nn">pytest_harvest</span> <span class="kn">import</span> <span class="n">saved_fixture</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="nd">@saved_fixture</span>
<span class="k">def</span> <span class="nf">dummy</span><span class="p">():</span>
    <span class="k">return</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">test_dummy</span><span class="p">(</span><span class="n">dummy</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">test_synthesis</span><span class="p">(</span><span class="n">fixture_store</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fixture_store</span><span class="p">[</span><span class="s1">&#39;dummy&#39;</span><span class="p">])</span>
</pre></div>


<p>Note that for session-scoped and module-scoped fixtures, not all test ids will appear in the store - only those for which the fixture was (re)created.</p>
<p>Users can save additional views created from the fixture instance by applying transforms (callable functions). To do this, users can provide a dictionary under the <code>views</code> argument, containing a <code>{&lt;key&gt;: &lt;procedure&gt;}</code> dict-like. For each entry, <code>&lt;procedure&gt;</code> will be applied on the fixture instance, and the result will be stored under <code>&lt;key&gt;</code>. <code>save_raw</code> controls whether the fixture instance should still be saved in this case (default: <code>True</code> if <code>views is None</code>, <code>False</code> otherwise).</p>
<p><strong>Parameters</strong></p>
<ul>
<li><strong>store</strong>: a dict-like object or a fixture name corresponding to a dict-like object. in this dictionary, a new entry will be added for the fixture. This entry will contain a dictionary <test_id>: <fixture_value> for each test node. By default fixtures are stored in the `fixture_store``fixture.</li>
<li><strong>key</strong>: the name associated with the stored fixture in the store. By default this is the fixture name.</li>
<li><strong>views</strong>: an optional dictionary that can be provided to store views created from the fixture, rather than (or in addition to, if <code>save_raw=True</code>) the fixture itself. The dict should contain a <code>{&lt;key&gt;: &lt;procedure&gt;}</code> dict-like. For each entry, <code>&lt;procedure&gt;</code> will be applied on the fixture instance, and the result will be stored under <code>&lt;key&gt;</code>.</li>
<li><strong>save_raw</strong>: controls whether the fixture instance should be saved. <code>None</code> (Default) is an automatic behaviour meaning "<code>True</code> if <code>views is None</code>, <code>False</code> otherwise".</li>
</ul>
<p><strong>Returns</strong>: a fixture that will be stored</p>
<p>See <a href="..#a--storing-fixture-instances">basic</a> and <a href="../advanced_usage/#2-storingretrieving-fixtures">advanced</a> documentation for details.</p>
<h4 id="resultsbag-class"><code>ResultsBag</code> class<a class="headerlink" href="#resultsbag-class" title="Permanent link">&para;</a></h4>
<p>The default type for result bags, used in the <code>results_bag</code> fixture and <code>create_results_bag_fixture</code> method.</p>
<p>It is a simple 'Munch', that is, a dual object/dict. It is hashable with a not very interesting hash, but at least a unique one in a python session (id(self)).</p>
<h3 id="b-intermediate">b- Intermediate<a class="headerlink" href="#b-intermediate" title="Permanent link">&para;</a></h3>
<h4 id="create_results_bag_fixture"><code>create_results_bag_fixture(...)</code><a class="headerlink" href="#create_results_bag_fixture" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="n">create_results_bag_fixture</span><span class="p">(</span><span class="n">store</span><span class="p">,</span>               <span class="c1"># type: Union[str, Dict[str, Any]]</span>
                           <span class="n">name</span><span class="o">=</span><span class="s1">&#39;results_bag&#39;</span><span class="p">,</span>  <span class="c1"># type: str</span>
                           <span class="n">bag_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>       <span class="c1"># type: Type[Any]</span>
                           <span class="p">)</span>
</pre></div>


<p>Creates a "results bag" fixture with name <code>name</code> stored in the given store (under key=<code>name</code>). By default results bags are instances of <a href="#resultsbag_class"><code>ResultsBag</code></a> but you can provide another <code>bag_type</code> if needed.</p>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p>store: a dict-like object or a fixture name corresponding to a dict-like object. in this dictionary, a new entry will be added for the fixture. This entry will contain a dictionary <test_id>: <fixture_value> for each test node.</p>
</li>
<li>
<p>name: the name associated with the stored fixture in the global store. By default this is 'results_bag'.</p>
</li>
<li>
<p>bag_type: the type of object to create as a results bag. Default: <code>ResultsBag</code></p>
</li>
</ul>
<h3 id="c-advanced">c- Advanced<a class="headerlink" href="#c-advanced" title="Permanent link">&para;</a></h3>
<h4 id="get_session_synthesis_dct"><code>get_session_synthesis_dct(...)</code><a class="headerlink" href="#get_session_synthesis_dct" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="n">get_session_synthesis_dct</span><span class="p">(</span><span class="n">session_or_request</span><span class="p">,</span>
                          <span class="n">test_id_format</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span>   <span class="c1">#</span>
                          <span class="n">status_details</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>    <span class="c1"># type: bool</span>
                          <span class="n">durations_in_ms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>   <span class="c1"># type: bool</span>
                          <span class="n">pytest_prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>      <span class="c1"># type: bool</span>
                          <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>             <span class="c1"># type: Any</span>
                          <span class="n">filter_incomplete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># type: bool</span>
                          <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>           <span class="c1"># type: bool</span>
                          <span class="n">fixture_store</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>      <span class="c1"># type: Union[Mapping[str, Any], Iterable[Mapping[str, Any]]]</span>
                          <span class="n">flatten_more</span><span class="o">=</span><span class="kc">None</span>        <span class="c1"># type: Union[str, Iterable[str], Mapping[str, str]]</span>
                          <span class="p">)</span>
</pre></div>


<p>Returns a dictionary containing a synthesis of what is available currently in the provided <code>pytest</code> <code>session</code> object.</p>
<p>For each entry, the key is the test id, and the value is a dictionary containing:</p>
<ul>
<li><code>'pytest_obj'</code>: the object under test, typically a test function</li>
<li><code>'pytest_status'</code>: the overall status (<code>'failing'</code>, <code>'skipped'</code>, <code>'passed'</code>)</li>
<li><code>'pytest_duration'</code>: the duration of the <code>'call'</code> step. By default this is the pytest unit (s) but if you set <code>durations_in_ms=True</code> it becomes (ms)</li>
<li><code>'pytest_status_details'</code>: a dictionary containing step-by-step status details for all pytest steps (<code>'setup'</code>, <code>'call'</code>, <code>'teardown'</code>). This is only included if <code>status_details=True</code> (not by default)</li>
</ul>
<p>It is possible to process the test id (the keys) using the <code>test_id_format</code> option. Let's assume that the id is </p>
<p><code>pytest_steps/tests_raw/test_wrapped_in_class.py::TestX::()::test_easy[p1-p2]</code>. </p>
<p>Here are the returned test ids depending on the selected <code>test_id_format</code></p>
<ul>
<li><code>'function'</code> will return <code>test_easy[p1-p2]</code></li>
<li><code>'class'</code> will return <code>TestX::()::test_easy[p1-p2]</code></li>
<li><code>'module'</code> will return <code>test_wrapped_in_class.py::TestX::()::test_easy[...]</code></li>
<li><code>'full'</code> will return the original id (this is the default behaviour)</li>
</ul>
<p>In addition one can provide a custom string handling function that will be called for each test id to process.</p>
<p>The 'pytest' prefix in front of all these items (except <code>pytest_obj</code>) is by default added in non-flatten mode and removed in flatten mode. To force one of these you can set <code>pytest_prefix</code> to <code>True</code> or <code>False</code>.</p>
<p>An optional <code>filter</code> can be provided, that can be a singleton or iterable of pytest objects (typically test functions) and/or module names.</p>
<p>If this method is called before the end of the pytest session, some nodes might be incomplete, i.e. they will not have data for the three stages (setup/call/teardown). By default these nodes are filtered out but you can set <code>filter_incomplete=False</code> to make them appear. They will have a special 'pending' synthesis status.</p>
<p>An optional collection of storage objects can be provided, so as to merge them into the resulting dictionary.</p>
<p>Finally a <code>flatten_output</code> option allows users to get a flat dictionary output instead of nested status details, parameters dict, and storage dicts.</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li><strong>session</strong>: a pytest session object.</li>
<li><strong>test_id_format</strong>: one of 'function', 'class', 'module', or 'full' (default), or a custom test id processing function.</li>
<li><strong>status_details</strong>: a flag indicating if pytest status details per stage (setup/call/teardown) should be included. Default=<code>False</code>: only the pytest status summary is provided.</li>
<li><strong>durations_in_ms</strong>: by default <code>pytest</code> measures durations in seconds so they are outputed in this unit. You can turn the flag to True to output milliseconds instead.</li>
<li><strong>pytest_prefix</strong>: to add (True) or remove (False) the 'pytest_' prefix in front of status, duration and status details. Typically useful in flatten mode when the names are not ambiguous. By default it is None, which means =(not flatten)</li>
<li><strong>filter</strong>: a singleton or iterable of pytest objects on which to filter the returned dict on (the returned items will only by pytest nodes for which the pytest object is one of the ones provided). One can also use module names. See <a href=""><code>pytest_item_matches_filter</code></a>.</li>
<li><strong>filter_incomplete</strong>: a boolean indicating if incomplete nodes (without the three stages setup/call/teardown)
    should appear in the results (False) or not (True, default).</li>
<li><strong>flatten</strong>: a boolean (default <code>False</code>) indicating if the resulting dictionary should be flattened. If it set to <code>True</code>, the 3 nested dictionaries (pytest status details, parameters, and optionally storages) will have their contents directly copied in the first level (with a prefix added in case of pytest status details).</li>
<li><strong>fixture_store</strong>: a singleton or iterable containing dict-like fixture storage objects (see <code>@saved_fixture</code> and <code>create_results_bag_fixture</code>). If flatten=<code>False</code> the contents of these dictionaries will be added to the output in a dedicated 'fixtures' entry. If flatten=True all of their contents will be included directly.</li>
<li><strong>flatten_more</strong>: a singleton, iterable or dictionary containing fixture names to flatten one level more in case flatten=True. If a dictionary is provided, the key should be the fixture name, and the value should be a prefix used for flattening its contents</li>
</ul>
<p><strong>Returns</strong>: a dictionary where the keys are pytest node ids. Each value is also a dictionary, containing information available from pytest concerning the test node, and optionally storage contents if <code>storage_dcts</code> is provided.</p>
<h4 id="filter_session_items"><code>filter_session_items(...)</code><a class="headerlink" href="#filter_session_items" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="n">filter_session_items</span><span class="p">(</span><span class="n">session</span><span class="p">,</span>
                     <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># type: Any</span>
                     <span class="p">)</span>
</pre></div>


<p>Filters pytest session item in the provided <code>session</code>. An optional <code>filter</code> can be provided, that can be a singleton or iterable of pytest objects (typically test functions) and/or module names.</p>
<p>Used in <a href="#get_session_synthesis_dct"><code>get_session_synthesis_dct</code></a>.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><strong>session</strong>: a pytest session</li>
<li><strong>filter</strong>: a singleton or iterable of pytest objects on which to filter the returned dict on (the returned items will only by pytest nodes for which the pytest object is one of the ones provided). One can also use module names.</li>
</ul>
<p><strong>Returns</strong>: an iterable containing possibly filtered session items</p>
<h4 id="pytest_item_matches_filter"><code>pytest_item_matches_filter(...)</code><a class="headerlink" href="#pytest_item_matches_filter" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="n">pytest_item_matches_filter</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">filter</span><span class="p">)</span>
</pre></div>


<p>Returns <code>True</code> if pytest session item <code>item</code> matches filter <code>filter</code>, <code>False</code> otherwise.</p>
<h3 id="d-pytest-utils">d- Pytest utils<a class="headerlink" href="#d-pytest-utils" title="Permanent link">&para;</a></h3>
<h4 id="get_all_pytest_fixture_names"><code>get_all_pytest_fixture_names(...)</code><a class="headerlink" href="#get_all_pytest_fixture_names" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="n">get_all_pytest_fixture_names</span><span class="p">(</span><span class="n">session</span><span class="p">,</span>
                             <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>              <span class="c1"># type: Any</span>
                             <span class="n">filter_incomplete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># type: bool</span>
                             <span class="p">)</span>
</pre></div>


<p>Returns the list of all unique fixture names used in all items in the provided session, with given filter.</p>
<p>An optional <code>filter</code> can be provided, that can be a singleton or iterable of pytest objects (typically test functions) and/or module names.</p>
<p>If this method is called before the end of the pytest session, some nodes might be incomplete, i.e. they will not have data for the three stages (setup/call/teardown). By default these nodes are filtered out but you can set <code>filter_incomplete=False</code> to make them appear. They will have a special 'pending' synthesis status.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><strong>session</strong>: a pytest session object.</li>
<li><strong>filter</strong>: a singleton or iterable of pytest objects on which to filter the returned dict on (the returned items will only by pytest nodes for which the pytest object is one of the ones provided). One can also use modules.</li>
<li><strong>filter_incomplete</strong>: a boolean indicating if incomplete nodes (without the three stages setup/call/teardown) should appear in the results (False) or not (True). Note: by default incomplete nodes DO APPEAR (this is different from get_session_synthesis_dct behaviour)</li>
</ul>
<p><strong>Returns</strong>: a list of fixture names corresponding to the desired filters</p>
<h4 id="get_all_pytest_param_names"><code>get_all_pytest_param_names(...)</code><a class="headerlink" href="#get_all_pytest_param_names" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="n">get_all_pytest_param_names</span><span class="p">(</span><span class="n">session</span><span class="p">,</span>
                           <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>              <span class="c1"># type: Any</span>
                           <span class="n">filter_incomplete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># type: bool</span>
                           <span class="p">)</span>
</pre></div>


<p>Returns the list of all unique parameter names used in all items in the provided session, with given filter.</p>
<p>An optional <code>filter</code> can be provided, that can be a singleton or iterable of pytest objects (typically test functions) and/or module names.</p>
<p>If this method is called before the end of the pytest session, some nodes might be incomplete, i.e. they will not have data for the three stages (setup/call/teardown). By default these nodes are filtered out but you can set <code>filter_incomplete=False</code> to make them appear. They will have a special 'pending' synthesis status.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><strong>session</strong>: a pytest session object.</li>
<li><strong>filter</strong>: a singleton or iterable of pytest objects on which to filter the returned dict on (the returned items will only by pytest nodes for which the pytest object is one of the ones provided). One can also use modules.</li>
<li><strong>filter_incomplete</strong>: a boolean indicating if incomplete nodes (without the three stages setup/call/teardown) should appear in the results (False) or not (True). Note: by default incomplete nodes DO APPEAR (this is different from get_session_synthesis_dct behaviour)</li>
</ul>
<p><strong>Returns</strong>: a list of parameter names corresponding to the desired filters</p>
<h4 id="get_fixture_value"><code>get_fixture_value(...)</code><a class="headerlink" href="#get_fixture_value" title="Permanent link">&para;</a></h4>
<p><code>get_fixture_value(request, fixture_name)</code></p>
<p>Returns the value associated with fixture named <code>fixture_name</code>, in provided <code>request</code> context. This is just an easy way to use <code>getfixturevalue</code> or <code>getfuncargvalue</code> according to whichever is available in current <code>pytest</code> version.</p>
<h4 id="get_pytest_status"><code>get_pytest_status(...)</code><a class="headerlink" href="#get_pytest_status" title="Permanent link">&para;</a></h4>
<p><code>get_pytest_status(item, durations_in_ms=False, current_request=None)</code></p>
<p>Returns a dictionary containing item's pytest status (success/skipped/failed, duration converted to ms) for
each pytest phase, and a tuple synthesizing the information.</p>
<p>The synthesis status contains the worst status of all phases (setup/call/teardown), or 'pending' if there are less than 3 phases.</p>
<p>The synthesis duration is equal to the duration of the 'call' phase (not to the sum of all phases: indeed, we are mostly interested in the test call itself).</p>
<p><strong>Parameters</strong></p>
<ul>
<li><strong>item</strong>: a pytest session.item</li>
<li><strong>durations_in_ms</strong>: by default <code>pytest</code> measures durations in seconds so they are outputed in this unit. You can turn the flag to True to output milliseconds instead.</li>
<li><strong>current_request</strong>: if a non-None <code>request</code> is provided and the item is precisely the one from the request, then the status will be 'pending'</li>
</ul>
<p><strong>Returns</strong>: a tuple ((test_status, test_duration), status_dct)</p>
<h4 id="is_pytest_incomplete"><code>is_pytest_incomplete(...)</code><a class="headerlink" href="#is_pytest_incomplete" title="Permanent link">&para;</a></h4>
<p><code>is_pytest_incomplete(item)</code></p>
<p>Returns <code>True</code> if a pytest item is incomplete - in other words if at least one of the 3 steps (setup/call/teardown) is missing from the available pytest report attached to this item.</p>
<h4 id="get_pytest_param_names"><code>get_pytest_param_names(...)</code><a class="headerlink" href="#get_pytest_param_names" title="Permanent link">&para;</a></h4>
<p><code>get_pytest_param_names(item)</code></p>
<p>Returns a list containing a pytest session item's parameters.</p>
<h4 id="get_pytest_params"><code>get_pytest_params(...)</code><a class="headerlink" href="#get_pytest_params" title="Permanent link">&para;</a></h4>
<p>Returns a dictionary containing a pytest session item's parameters.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../changelog/" title="Changelog" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Changelog
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>